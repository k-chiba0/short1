
# 📈 Short Position Plot

`short_position_plot.py` は、東京証券取引所が公開している「空売り残高」データと株価時系列データを組み合わせ、特定銘柄における機関別の空売り推移と株価の関係を可視化するツールです。

---

## 📌 特徴

- 指定した銘柄コードの空売り残高（機関別）を日付ごとにプロット  
- 株価（終値）データと同時に表示し、空売りと価格の相関を分析  
- 複数日・複数ファイルのExcelデータから自動抽出  
- matplotlib によるグラフ出力 + CSVへのデータ保存

---

## 📁 入出力ファイル

### 入力ファイル

- `D:/short/data/` に格納された Excel ファイル（例: `20250529_Short_Positions.xlsx`）  
　┗ 空売り残高データ（複数日・機関別）
- `D:/short/Chart/` にある株価CSV（例: `TimeChart(5253)20250426.csv`）  
　┗ 銘柄コードごとの時系列データ（列名: 日付, 始値, 高値, 安値, 終値, 出来高など）

### 出力ファイル

- 機関別空売り推移 + 株価のグラフ（PNG等）
- `D:/short/` に `5253_short_positions.csv` のような集計CSV

---

## ▶️ 使い方

```bash
python short_position_plot.py --ticker 5253
```

### 引数

| 引数         | 説明                                       |
|--------------|--------------------------------------------|
| `--ticker`   | 対象の銘柄コード（例: `5253`）             |
| `--output`   | 出力CSV/グラフの保存先ディレクトリ（省略可）|
| `--show`     | グラフを表示（オプション）                  |

---

## 🧩 依存ライブラリ

以下のPythonパッケージを使用しています。

```bash
pip install pandas matplotlib openpyxl
```

---

## 📝 注意点

- 空売り残高Excelファイルの形式は、東証公表の形式に準拠している必要があります。  
- 株価データのCSVは1行目に列名、2行目以降にデータ。日付形式は `"yyyy/m/d"` を想定。  
- カンマ区切りの数値（例: `"1,234,567"`）にも対応しています。

---

## 📌 今後の改善案

- 平均空売り単価の算出機能の追加  
- 空売り比率の計算（発行済株式数を元に）  
- GUIで銘柄選択や日付指定が可能なフロントエンド追加

---

## 🧑‍💻 開発者

- GitHub: [k-chiba0](https://github.com/k-chiba0)
